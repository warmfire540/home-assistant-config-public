title: "Lights"
path: "lights"
type: custom:grid-layout
layout:
  grid-template-columns: auto
  grid-template-rows: auto
  grid-template-areas: |
    "nav title status killswitch"
    "lights-on switches-on lights-off switches-off"
  mediaquery:
    # portrait monitor
    "only screen and (min-width: 769px) and (max-width: 1400px)":
      grid-template-areas: |
        "nav ."
        "title killswitch"
        "status status"
        "lights-on switches-on"
        "lights-off switches-off"
    # Smartphones
    "only screen and (max-width: 768px)":
      grid-template-areas: |
        "nav ."
        "title killswitch"
        "status status"
        "lights-on lights-on"
        "switches-on switches-on"
        "lights-off lights-off"
        "switches-off switches-off"
cards:
  - type: "custom:button-card"
    template: chip_back
    view_layout:
      grid-area: nav
    variables:
      ulm_chip_back_path: home

  - type: "custom:button-card"
    template: card_title
    name: Lights
    view_layout:
      grid-area: title

  #################
  # STATUS CHIPS
  #################
  - type: custom:mod-card
    view_layout:
      grid-area: status
    style:
      hui-horizontal-stack-card$: |
        #root { 
          justify-content: center;
        }
    card:
      type: horizontal-stack
      cards:
        - type: custom:button-card
          template: chip_icon_state_if_value
          variables:
            entity: sensor.lights_on
            on_color: var(--amber-color)
        - type: custom:button-card
          template: chip_icon_state_if_value
          variables:
            entity: sensor.switches_on
            on_color: var(--amber-color)

  - type: "custom:button-card"
    template: chip_icon_label
    label: Kill lights
    icon: "mdi:power-plug-off"
    view_layout:
      grid-area: killswitch
    tap_action:
      action: call-service
      service: script.turn_off_house
    styles:
      icon:
        - color: >
            [[[ if (states['sensor.lights_on'].state >= 1) 
                  return "var(--green-color)" ;
                else return "var(--red-color)"; ]]]

  - type: custom:auto-entities
    view_layout:
      grid-area: lights-on
    card:
      type: glance
      title: Lights on
    else:
      type: markdown
      content: >-
        <ha-alert alert-type="info">No lights on!</ha-alert>
    filter:
      include:
        - group: group.all_lights
          state: "on"
          options:
            tap_action:
              action: toggle

  - type: custom:auto-entities
    view_layout:
      grid-area: switches-on
    card:
      type: glance
      title: Switches on
    else:
      type: markdown
      content: >-
        <ha-alert alert-type="info">No switches on!</ha-alert>
    filter:
      include:
        - group: group.all_light_switches
          state: "on"
          options:
            tap_action:
              action: toggle

  - type: custom:auto-entities
    view_layout:
      grid-area: lights-off
    card:
      type: glance
      title: Lights off
    else:
      type: markdown
      content: >-
        <ha-alert alert-type="info">No lights off!</ha-alert>
    filter:
      include:
        - group: group.all_lights
          state: "off"
          options:
            tap_action:
              action: toggle

  - type: custom:auto-entities
    view_layout:
      grid-area: switches-off
    card:
      type: glance
      title: Switches off
    else:
      type: markdown
      content: >-
        <ha-alert alert-type="info">No switches off!</ha-alert>
    filter:
      include:
        - group: group.all_light_switches
          state: "off"
          options:
            tap_action:
              action: toggle
