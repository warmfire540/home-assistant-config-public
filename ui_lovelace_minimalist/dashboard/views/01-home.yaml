title: "Home"
path: "home"
type: custom:grid-layout
layout:
  grid-template-columns: auto
  grid-template-rows: auto
  grid-template-areas: |
    "welcome people"
    "welcome status"
    "rooms rooms"
  mediaquery:
    "(max-width: 768px)":
      grid-template-areas: |
        "welcome"
        "people"
        "status"
        "rooms"
cards:
  - type: custom:button-card
    template: card_esh_welcome
    triggers_update: "input_boolean.welcome_toggle"
    view_layout:
      grid-area: welcome
    variables:
      ulm_card_esh_welcome_collapse: input_boolean.welcome_toggle
      ulm_current_scene: sensor.last_scene
      ulm_weather: weather.forecast_home
      entity_1:
        nav: house
        icon: mdi:home
        name: House
        color: blue
      entity_2:
        nav: lights
        icon: mdi:lightbulb
        name: Lights
        color: yellow
      entity_3:
        nav: cats
        icon: mdi:cat
        name: Cats
        color: green
      entity_4:
        nav: lab
        icon: mdi:flask
        name: Lab
        color: purple
      entity_5:
        nav: network
        icon: mdi:network
        name: Net
        color: red
      subview_1:
        nav: t1d
        icon: mdi:diabetes
        color: blue

  - type: horizontal-stack
    view_layout:
      grid-area: people
    cards:
      - type: custom:button-card
        template: card_person
        variables:
          ulm_card_person_entity: person.poat
          ulm_card_person_use_entity_picture: true
          ulm_address: sensor.poat_s_iphone_14_pro_max_geocoded_location
          ulm_card_person_battery: sensor.poat_s_iphone_14_pro_max_battery_level
      - type: custom:button-card
        template: card_person
        variables:
          ulm_card_person_entity: person.gina
          ulm_card_person_use_entity_picture: true
          ulm_address: sensor.gina_s_iphone_13_mini_geocoded_location
          ulm_card_person_battery: sensor.gina_s_iphone_13_mini_battery_level

  - type: vertical-stack
    view_layout:
      grid-area: status
    cards:
      - type: custom:button-card
        template: card_title
        label: Status Updates

      #################
      # STATUS CHIPS
      #################
      - type: custom:mod-card
        style:
          hui-horizontal-stack-card$: |
            #root { 
              justify-content: center;
            }
        card:
          type: horizontal-stack
          cards:
            - type: custom:button-card
              template: chip_icon_state_if_value
              variables:
                optional: true
                entity: sensor.devices_with_low_battery
                navigation_path: "/the-matrix/house?anchor=low-battery"
            - type: custom:button-card
              template: chip_icon_state_if_value
              variables:
                optional: true
                entity: sensor.cat_device_failure_count
                navigation_path: "/the-matrix/cats?anchor=status"
            - type: custom:button-card
              template: chip_icon_state_if_value
              variables:
                optional: true
                entity: sensor.devices_offline
                navigation_path: "/the-matrix/network?anchor=disconnected"
            - type: custom:button-card
              template: chip_icon_state_if_value
              variables:
                optional: true
                entity: group.leak_sensors
            - type: custom:button-card
              template: chip_icon_state_if_value
              variables:
                optional: true
                entity: sensor.updates_available
                navigation_path: "/the-matrix/network?anchor=updates"
            - type: custom:button-card
              template: chip_icon_state_if_value
              variables:
                entity: sensor.seedbox_vpn_on
                ulm_chip_mdi_icon_only_icon: mdi:vpn
              styles:
                icon:
                  - color: >
                      [[[ if (states["sensor.seedbox_vpn_on"].state == "False")
                          return "var(--red-color)";
                        else if (states["sensor.seedbox_vpn_on"].state == "Offline")
                          return "var(--amber-color)";
                        else
                          return "var(--green-color)"; ]]]
            - type: custom:button-card
              template: poat_chip_double_state
              variables:
                ulm_chip_icon_double_state_icon: "❗"
                ulm_chip_icon_double_state_icon_2: "⚠️"
                ulm_chip_icon_double_state_entity_1: counter.homeassistant_errors
                ulm_chip_icon_double_state_entity_2: counter.homeassistant_warnings
                ulm_chip_navigate_path: /config/logs
              state:
                - operator: template
                  value: >
                    [[[ return states['counter.homeassistant_errors'].state === '0' 
                      && states['counter.homeassistant_warnings'].state === '0' ]]]
                  styles:
                    card:
                      - display: none

  #############
  # ROOM CARDS
  #############
  - type: custom:layout-card
    layout_type: custom:grid-layout
    layout:
      # desktop screen
      grid-template-columns: repeat(6, 1fr)
      grid-template-rows: auto
      grid-template-areas: |
        "label label label label label label"
        "living dining office kitchen bedroom bath"
        "guest spare garage attic shed ."
      mediaquery:
        # portrait monitor
        "only screen and (min-width: 769px) and (max-width: 1400px)":
          grid-template-columns: repeat(4, 1fr)
          grid-template-areas: |
            "label label label label"
            "living dining office kitchen "
            "bedroom bath guest spare"
            "garage attic shed ."
        # Smartphones
        "only screen and (max-width: 768px)":
          grid-template-columns: 1fr 1fr
          grid-template-areas: |
            "label label"
            "living dining"
            "office kitchen"
            "bedroom bath"
            "guest spare"
            "garage attic"
            "shed ."
    view_layout:
      grid-area: rooms
    cards:
      - type: custom:button-card
        template: card_title
        name: Rooms
        variables:
          grid-area: label

      #################
      # LIVING ROOM
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:sofa
        view_layout:
          grid-area: living
        variables:
          affix: living_room
          problem_entities:
            - binary_sensor.rolo_error
            - binary_sensor.living_room_smoke_sensor_smoke_detected
            - binary_sensor.living_room_smoke_sensor_carbon_monoxide_detected
          entity_2:
            entity_id: switch.living_room_switch_switch_1
            templates:
              - yellow_on
          entity_3:
            entity_id: light.tv_led
            templates:
              - blue_on
          entity_4:
            entity_id: climate.living_room
            templates:
              - yellow_on
              - climate_icon

      #################
      # DINING ROOM
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:glass-cocktail
        view_layout:
          grid-area: dining
        variables:
          affix: dining_room

      #################
      # OFFICE
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:controller
        view_layout:
          grid-area: office
        variables:
          affix: office
          problem_entities:
            - binary_sensor.office_smoke_sensor_smoke_detected
            - binary_sensor.office_smoke_sensor_carbon_monoxide_detected
          entity_2:
            entity_id: switch.office_switch_switch_1
            templates:
              - yellow_on
          entity_3:
            entity_id: binary_sensor.poat_rgb_connectivity
            templates:
              - blue_on
          entity_4:
            entity_id: switch.office_fan
            templates:
              - blue_on

      #################
      # KITCHEN
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:countertop-outline
        view_layout:
          grid-area: kitchen
        variables:
          affix: kitchen
          problem_entities:
            - group.cat_water_status
            - binary_sensor.dishwasher_leak_sensor
          entity_2:
            entity_id: switch.under_cabinet_lights_switch_1
            templates:
              - yellow_on
          entity_3:
            entity_id: switch.dinette_light_switch_1
            templates:
              - yellow_on

      #################
      # MASTER BEDROOM
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:bed
        view_layout:
          grid-area: bedroom
        variables:
          affix: master_bedroom

      #################
      # MASTER BATHROOM
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:shower-head
        view_layout:
          grid-area: bath
        variables:
          affix: master_bath
          entity_2:
            entity_id: switch.master_bath_fan_relay_2
            templates:
              - yellow_on
          entity_3:
            entity_id: switch.master_bath_fan_relay
            templates:
              - blue_on

      #################
      # GUEST ROOM
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:desk
        view_layout:
          grid-area: guest
        variables:
          affix: guest_bedroom
          entity_1:
            entity_id: switch.gina_computer_socket_1
            templates:
              - blue_on

      #################
      # GUEST BATHROOM
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:shower
        view_layout:
          grid-area: spare
        variables:
          affix: guest_bath
          problem_entities:
            - group.cat_food_status

      #################
      # GARAGE
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        entity: switch.garage_opener_socket_1
        icon: mdi:garage
        view_layout:
          grid-area: garage
        variables:
          affix: garage
          temperature_threshold: 90
          problem_entities:
            - binary_sensor.water_heater_leak_sensor
            - binary_sensor.strong_boi_error
          entity_1:
            entity_id: switch.garage_opener_socket_1
            templates:
              - blue_on
          entity_2:
            entity_id: input_boolean.washing_machine_on
            templates:
              - blue_on
          entity_3:
            entity_id: input_boolean.dryer_on
            templates:
              - blue_on
          entity_4:
            entity_id: binary_sensor.dryer_door_sensor_window_door_is_open
            templates:
              - blue_on

      #################
      # ATTIC
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:home-roof
        view_layout:
          grid-area: attic
        variables:
          affix: attic
          temperature_threshold: 100
          problem_entities:
            - binary_sensor.ac_pan_leak_sensor

      #################
      # Shed
      #################
      - type: custom:button-card
        template:
          - poat_card_room
        icon: mdi:greenhouse
        view_layout:
          grid-area: shed
        variables:
          affix: shed
          temperature_threshold: 90
          entity_1:
            entity_id: binary_sensor.shed_door_sensor_window_door_is_open
            templates:
              - red_on
